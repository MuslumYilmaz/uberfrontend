<div class="sdl-root">
    <div class="sdl-main">
        <!-- LEFT : fixed rail -->
        <!-- LEFT : Problem brief (fixed) -->
        <aside class="left">
            <div class="left-inner">
                <div class="left-head">
                    <h1 class="title" [title]="title()">{{ title() }}</h1>
                </div>

                <!-- scrollable content -->
                <div class="left-body">
                    <div class="desc">{{ description() }}</div>

                    <div class="tags">
                        <p-chip *ngFor="let tag of tags()" [label]="tag" styleClass="custom-chip"></p-chip>
                    </div>
                </div>

                <!-- pinned bottom (like right toc foot) -->
                <div class="left-foot">
                    <div class="guide">
                        New to RADIO?
                        <a routerLink="/guides/radio">Read the guide</a> first.
                    </div>
                </div>
            </div>
        </aside>

        <!-- CENTER : article -->
        <main class="center">
            <ng-container *ngFor="let s of sections()">
                <section class="sd-section" [attr.id]="anchorId(s.key)">
                    <h2 class="sd-h2" #sectionHeading [attr.data-key]="s.key">{{ s.title }}</h2>

                    <div class="sd-blocks">
                        <!-- Prefer blocks; fallback to legacy content -->
                        <ng-container *ngIf="s.blocks?.length; else legacyText">
                            <ng-container *ngFor="let b of s.blocks">
                                <!-- TEXT -->
                                <div *ngIf="b.type === 'text'" class="sd-text">{{ b.text }}</div>

                                <!-- CODE (Monaco, non-interactive, auto height unless explicit height) -->
                                <div *ngIf="b.type === 'code'">
                                    <app-monaco-editor class="sd-code" [code]="b.code"
                                        [language]="b.language || 'typescript'" [readOnly]="true" [interactive]="false"
                                        [autoHeight]="!b.height" [options]="codeViewerOptions"
                                        [style.height.px]="b.height || null">
                                    </app-monaco-editor>
                                </div>

                                <!-- IMAGE -->
                                <figure *ngIf="b.type === 'image'" class="sd-figure">
                                    <img [src]="asset(b.src)" [alt]="b.alt || ''" [style.width.px]="b.width || null" />
                                    <figcaption *ngIf="b.caption">{{ b.caption }}</figcaption>
                                </figure>
                            </ng-container>
                        </ng-container>

                        <ng-template #legacyText>
                            <div class="sd-text">{{ s.content }}</div>
                        </ng-template>
                    </div>
                </section>
            </ng-container>
        </main>

        <!-- RIGHT : fixed TOC -->
        <nav class="right">
            <div class="toc">
                <div class="toc-head">On this page</div>
                <ul class="toc-list">
                    <li *ngFor="let s of sections()">
                        <button class="toc-item" [class.active]="activeKey()===s.key" (click)="scrollToKey(s.key)">
                            {{ s.title }}
                        </button>
                    </li>
                </ul>
                <div class="toc-foot">
                    <button class="top-btn" (click)="scrollTop()">Back to top</button>
                </div>
            </div>
        </nav>
    </div>

    <!-- global footer below content -->
    <app-footer></app-footer>
</div>