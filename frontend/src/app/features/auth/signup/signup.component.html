<div class="auth-page" data-testid="signup-page">
  <section class="auth-left">
    <div class="auth-card">
      <h1 class="auth-title">Create a new account</h1>

      <div class="auth-socials">
        <button type="button" class="btn-surface" data-testid="signup-google" (click)="auth.oauthStart('google','signup')">
          <i class="fa-brands fa-google social-icon" aria-hidden="true"></i>
          Continue with Google
        </button>
        <button type="button" class="btn-surface" data-testid="signup-github" (click)="auth.oauthStart('github','signup')">
          <i class="fa-brands fa-github social-icon" aria-hidden="true"></i>
          Continue with GitHub
        </button>
      </div>

      <div class="divider">
        <span class="line"></span>
        <span class="label">or</span>
        <span class="line"></span>
      </div>

      <form [formGroup]="form" (ngSubmit)="submit()" class="auth-form">
        <label class="field">
          <span>Email</span>
          <input data-testid="signup-email" formControlName="email" type="email" placeholder="you@example.com" />
        </label>
        <div *ngIf="showError(emailCtrl) && emailCtrl?.errors" class="error" data-testid="signup-email-error">
          <ng-container *ngIf="emailCtrl?.errors?.['required']">Email is required.</ng-container>
          <ng-container *ngIf="emailCtrl?.errors?.['email']">Enter a valid email address.</ng-container>
          <ng-container *ngIf="emailCtrl?.errors?.['duplicate']">Email is already in use.</ng-container>
        </div>

        <label class="field">
          <span>Username</span>
          <input data-testid="signup-username" formControlName="username" type="text" placeholder="jane_doe" />
        </label>
        <div *ngIf="showError(usernameCtrl) && usernameCtrl?.errors" class="error" data-testid="signup-username-error">
          <ng-container *ngIf="usernameCtrl?.errors?.['required']">Username is required.</ng-container>
          <ng-container *ngIf="usernameCtrl?.errors?.['minlength']">Username must be at least 3 characters.</ng-container>
          <ng-container *ngIf="usernameCtrl?.errors?.['duplicate']">Username is already in use.</ng-container>
        </div>

        <div formGroupName="passwords" class="auth-form">
          <label class="field">
            <span>Password</span>
            <input data-testid="signup-password" formControlName="password" type="password" placeholder="••••••••" />
          </label>
          <div *ngIf="showError(passwordCtrl) && passwordCtrl?.errors" class="error" data-testid="signup-password-error">
            <ng-container *ngIf="passwordCtrl?.errors?.['required']">Password is required.</ng-container>
            <ng-container *ngIf="passwordCtrl?.errors?.['minlength']">Password must be at least 8 characters.</ng-container>
            <ng-container *ngIf="passwordCtrl?.errors?.['pattern']">Use at least 8 characters with a letter and a number.</ng-container>
          </div>

          <label class="field">
            <span>Confirm Password</span>
            <input data-testid="signup-confirm" formControlName="confirmPassword" type="password" placeholder="••••••••" />
          </label>
          <div *ngIf="showError(confirmCtrl) && confirmCtrl?.errors" class="error" data-testid="signup-confirm-error">
            <ng-container *ngIf="confirmCtrl?.errors?.['required']">Please confirm your password.</ng-container>
          </div>

          <div *ngIf="form.hasError('mismatch') && (showError(confirmCtrl) || showError(passwordCtrl))" class="error" data-testid="signup-mismatch">
            Passwords do not match
          </div>
        </div>

        <button type="submit" class="btn-primary" data-testid="signup-submit" [disabled]="loading">
          {{ loading ? 'Creating account…' : 'Sign Up' }}
        </button>

        <div *ngIf="error" class="error" data-testid="signup-error">{{ error }}</div>
      </form>

      <p class="meta">
        Already have an account?
        <a routerLink="/auth/login" data-testid="signup-link-login">Sign in</a>
      </p>
    </div>
  </section>

  <aside class="auth-aside">
    <div class="aside-card">
      <header>
        <div class="aside-kicker">FrontendAtlas • What you’ll get</div>
        <h2>Practice smarter, ship faster</h2>
      </header>

      <ul class="aside-list">
        <li>
          <span><i class="pi pi-code"></i></span>
          <div><strong>Hands-on coding</strong> — Hands-on coding — solve real tasks with a live editor.</div>
        </li>
        <li>
          <span><i class="pi pi-check-circle"></i></span>
          <div><strong>Built-in test runner</strong> — run tests, view results, and add custom cases.</div>
        </li>
        <li>
          <span><i class="pi pi-book"></i></span>
          <div><strong>System design & trivia</strong> — quick drills and deep dives to round out skills.</div>
        </li>
        <li>
          <span><i class="pi pi-save"></i></span>
          <div><strong>Save & resume</strong> — your work persists; reset to the starter anytime.</div>
        </li>
        <li>
          <span><i class="pi pi-chart-line"></i></span>
          <div><strong>Growing library</strong> — more exercises and capabilities added regularly.</div>
        </li>
      </ul>

      <p class="aside-note">A focused, no-fluff workspace to prep for real frontend interviews.</p>
    </div>
  </aside>
</div>
