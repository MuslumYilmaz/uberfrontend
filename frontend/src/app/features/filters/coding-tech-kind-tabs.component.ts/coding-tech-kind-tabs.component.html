<div class="mb-4 overflow-x-auto" *ngIf="source!=='company'">
  <h1 class="text-4xl font-extrabold text-white mb-6">
    {{ heading() }}
  </h1>

  <nav class="chip-row">
    <!-- GLOBAL (/coding): choose by viewMode -->
    <ng-container *ngIf="source==='global-coding'">
      <!-- Formats mode: CATEGORY pills -->
      <ng-container *ngIf="viewMode === 'formats'; else globalTechPills">
        <fa-chip *ngFor="let c of categoryTabs"
                 size="md"
                 [selected]="selectedCategory === c.key"
                 (selectedChange)="categoryToggled.emit(c.key)">
          <span class="whitespace-nowrap">{{ c.label }}</span>
        </fa-chip>
      </ng-container>

      <!-- Tech mode: TECH filter pills -->
      <ng-template #globalTechPills>
        <fa-chip *ngFor="let t of techTabs"
                 size="md"
                 [selected]="selectedTech === t.key"
                 (selectedChange)="techSelected.emit(t.key)">
          <span class="tech-badge" [ngClass]="t.cls">{{ t.badge }}</span>
          <span class="whitespace-nowrap">{{ t.label }}</span>
        </fa-chip>
      </ng-template>
    </ng-container>

    <!-- Per-tech routes: navigation pills -->
    <ng-container *ngIf="source!=='global-coding'">
      <fa-chip *ngFor="let t of techTabs"
               size="md"
               [routerLink]="['/', t.key, kind]"
               [queryParams]="navQueryParams"
               [toggle]="false"
               [selected]="t.key === tech">
        <span class="tech-badge" [ngClass]="t.cls">{{ t.badge }}</span>
        <span class="whitespace-nowrap">{{ t.label }}</span>
      </fa-chip>
    </ng-container>
  </nav>
</div>

<!-- Section tabs + right-side count -->
<div *ngIf="source!=='company'" class="tabs-row">
  <div class="tabs-left">
    <!-- GLOBAL (/coding): render kind pills unless System design is active -->
    <ng-container *ngIf="source==='global-coding'; else perTechKindLinks">
      <ng-container *ngIf="!isSystemCategoryActive">
        <fa-chip size="sm" [selected]="selectedKind === 'all'" (selectedChange)="kindSelected.emit('all')">
          All
        </fa-chip>

        <fa-chip size="sm" [selected]="selectedKind === 'coding'" (selectedChange)="kindSelected.emit('coding')">
          Coding
        </fa-chip>

        <fa-chip size="sm" [selected]="selectedKind === 'trivia'" (selectedChange)="kindSelected.emit('trivia')">
          Quiz
        </fa-chip>
      </ng-container>
    </ng-container>

    <!-- PER-TECH pages: show nav links -->
    <ng-template #perTechKindLinks>
      <fa-chip *ngFor="let k of kindTabs"
               size="sm"
               [routerLink]="['/', tech || 'javascript', k.key]"
               [queryParams]="navQueryParams"
               [toggle]="false"
               [selected]="k.key === kind">
        {{ k.label }}
      </fa-chip>
    </ng-template>
  </div>

  <div class="tabs-right">
    <fa-chip class="count-chip" size="sm" [toggle]="false">
      {{ filteredCount }} questions
    </fa-chip>
  </div>
</div>
