{
  "version": "v1",
  "type": "user-interface",
  "title": "React Invite Chips Input (solution)",
  "openFile": "/src/App.tsx",
  "dependencies": {
    "react": "18.x",
    "react-dom": "18.x",
    "react-scripts": "5.0.1"
  },
  "files": {
    "/package.json": {
      "code": "{\n  \"name\": \"react-chips-input-autocomplete-solution\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"react\": \"18.x\",\n    \"react-dom\": \"18.x\",\n    \"react-scripts\": \"5.0.1\"\n  },\n  \"scripts\": { \"start\": \"react-scripts start\" }\n}\n"
    },
    "/public/index.html": {
      "code": "<!doctype html><html lang=\"en\"><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><title>React SDK • Invite Chips (solution)</title></head><body><div id=\"root\"></div></body></html>"
    },
    "/src/index.tsx": {
      "code": "import { createRoot } from 'react-dom/client';\nimport App from './App';\n\ncreateRoot(document.getElementById('root')!).render(<App />);\n"
    },
    "/src/App.tsx": {
      "code": "import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\nimport './App.css';\n\ntype Candidate = {\n  id: string;\n  name: string;\n  email: string;\n};\n\ntype Chip = {\n  id: string;\n  label: string;\n  value: string;\n};\n\ntype KeyInputEvent = {\n  key: string;\n  preventDefault: () => void;\n};\n\nconst USERS: Candidate[] = [\n  { id: 'alice', name: 'Alice Johnson', email: 'alice@frontendatlas.dev' },\n  { id: 'bob', name: 'Bob Smith', email: 'bob@frontendatlas.dev' },\n  { id: 'charlie', name: 'Charlie Kim', email: 'charlie@frontendatlas.dev' },\n  { id: 'diana', name: 'Diana Lopez', email: 'diana@frontendatlas.dev' },\n  { id: 'ethan', name: 'Ethan Brown', email: 'ethan@frontendatlas.dev' },\n  { id: 'fiona', name: 'Fiona Patel', email: 'fiona@frontendatlas.dev' },\n  { id: 'george', name: 'George Miller', email: 'george@frontendatlas.dev' }\n];\n\nfunction normalize(value: string): string {\n  return value.trim().toLowerCase();\n}\n\nfunction createCandidateChip(user: Candidate): Chip {\n  return {\n    id: user.id,\n    label: user.name,\n    value: user.email\n  };\n}\n\nexport default function App() {\n  const rootRef = useRef<HTMLDivElement | null>(null);\n\n  const [chips, setChips] = useState<Chip[]>([]);\n  const [query, setQuery] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [activeIndex, setActiveIndex] = useState(-1);\n\n  const listboxId = 'invite-suggestions';\n\n  const suggestions = useMemo<Chip[]>(() => {\n    const needle = normalize(query);\n    if (!needle) return [];\n\n    const selectedIds = new Set(chips.map((chip) => chip.id));\n\n    return USERS\n      .filter((user) => {\n        if (selectedIds.has(user.id)) return false;\n        const haystack = (user.name + ' ' + user.email).toLowerCase();\n        return haystack.includes(needle);\n      })\n      .slice(0, 6)\n      .map(createCandidateChip);\n  }, [chips, query]);\n\n  const addChip = useCallback((chip: Chip) => {\n    setChips((prev) => {\n      const hasDuplicate = prev.some((item) => item.id === chip.id || normalize(item.value) === normalize(chip.value));\n      if (hasDuplicate) return prev;\n      return [...prev, chip];\n    });\n    setQuery('');\n    setIsOpen(false);\n    setActiveIndex(-1);\n  }, []);\n\n  const addCustomFromQuery = useCallback(() => {\n    const raw = query.trim();\n    if (!raw) return;\n\n    addChip({\n      id: 'custom-' + normalize(raw),\n      label: raw,\n      value: raw\n    });\n  }, [addChip, query]);\n\n  const removeChip = useCallback((chipId: string) => {\n    setChips((prev) => prev.filter((chip) => chip.id !== chipId));\n  }, []);\n\n  const selectSuggestion = useCallback((chip: Chip) => {\n    addChip(chip);\n  }, [addChip]);\n\n  const handleKeyDown = (event: KeyInputEvent) => {\n    if (event.key === 'ArrowDown') {\n      event.preventDefault();\n      if (!suggestions.length) return;\n      setIsOpen(true);\n      setActiveIndex((prev) => (prev < 0 ? 0 : (prev + 1) % suggestions.length));\n      return;\n    }\n\n    if (event.key === 'ArrowUp') {\n      event.preventDefault();\n      if (!suggestions.length) return;\n      setIsOpen(true);\n      setActiveIndex((prev) => (prev < 0 ? suggestions.length - 1 : (prev - 1 + suggestions.length) % suggestions.length));\n      return;\n    }\n\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      if (isOpen && activeIndex >= 0 && activeIndex < suggestions.length) {\n        addChip(suggestions[activeIndex]);\n      } else {\n        addCustomFromQuery();\n      }\n      return;\n    }\n\n    if (event.key === ',') {\n      event.preventDefault();\n      addCustomFromQuery();\n      return;\n    }\n\n    if (event.key === 'Backspace' && !query && chips.length > 0) {\n      setChips((prev) => prev.slice(0, -1));\n      return;\n    }\n\n    if (event.key === 'Escape') {\n      setIsOpen(false);\n      setActiveIndex(-1);\n    }\n  };\n\n  useEffect(() => {\n    setActiveIndex(-1);\n  }, [query]);\n\n  useEffect(() => {\n    const hasQuery = normalize(query).length > 0;\n    setIsOpen(hasQuery && suggestions.length > 0);\n  }, [query, suggestions.length]);\n\n  useEffect(() => {\n    function onDocMouseDown(event: MouseEvent) {\n      const target = event.target as Node | null;\n      if (!target || !rootRef.current) return;\n      if (!rootRef.current.contains(target)) {\n        setIsOpen(false);\n        setActiveIndex(-1);\n      }\n    }\n\n    document.addEventListener('mousedown', onDocMouseDown);\n    return () => document.removeEventListener('mousedown', onDocMouseDown);\n  }, []);\n\n  const activeDescendant =\n    activeIndex >= 0 ? 'invite-option-' + String(activeIndex) : undefined;\n\n  return (\n    <main className='page'>\n      <section className='card'>\n        <h1>Invite people</h1>\n        <p className='subtitle'>\n          Build a chips input with autocomplete, keyboard shortcuts, and removable tags.\n        </p>\n\n        <div\n          ref={rootRef}\n          className='combobox'\n          role='combobox'\n          aria-expanded={isOpen}\n          aria-haspopup='listbox'\n          aria-owns={listboxId}\n          aria-activedescendant={activeDescendant}\n        >\n          <div className='chip-input'>\n            {chips.map((chip) => (\n              <span className='chip' key={chip.id}>\n                <span>{chip.label}</span>\n                <button\n                  type='button'\n                  className='chip-remove'\n                  onClick={() => removeChip(chip.id)}\n                  aria-label={'Remove ' + chip.label}\n                >\n                  ×\n                </button>\n              </span>\n            ))}\n\n            <input\n              type='text'\n              value={query}\n              onChange={(event) => setQuery(event.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder='Type a name or email...'\n            />\n          </div>\n\n          {isOpen && (\n            <ul id={listboxId} className='suggestions' role='listbox'>\n              {suggestions.map((item, index) => (\n                <li\n                  key={item.id}\n                  id={'invite-option-' + String(index)}\n                  role='option'\n                  aria-selected={index === activeIndex}\n                  className={index === activeIndex ? 'suggestion active' : 'suggestion'}\n                  onMouseDown={() => selectSuggestion(item)}\n                >\n                  <strong>{item.label}</strong>\n                  <span>{item.value}</span>\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n\n        <p className='hint'>\n          Keyboard: Arrow keys navigate, Enter/comma add chip, Backspace removes the last chip.\n        </p>\n      </section>\n    </main>\n  );\n}\n"
    },
    "/src/App.css": {
      "code": ":root{color-scheme:dark;}\nhtml,body{margin:0;height:100%;background:#0a0a0a;}\nbody{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}\n.page{min-height:100vh;display:grid;place-items:center;padding:24px;background:#0a0a0a;color:#e5e7eb;}\n.card{width:100%;max-width:640px;background:#0b1020;border:1px solid #1f2937;border-radius:14px;padding:18px;display:grid;gap:12px;}\nh1{margin:0;font-size:20px;}\n.subtitle{margin:0;color:#9ca3af;font-size:14px;line-height:1.45;}\n.combobox{position:relative;}\n.chip-input{display:flex;flex-wrap:wrap;align-items:center;gap:8px;padding:10px;border-radius:12px;border:1px solid #374151;background:#0a0f1e;}\n.chip-input:focus-within{border-color:#a3e635;box-shadow:0 0 0 2px rgba(163,230,53,.15);}\n.chip{display:inline-flex;align-items:center;gap:8px;padding:4px 10px;border-radius:999px;background:#172036;border:1px solid #2c3c62;font-size:13px;}\n.chip-remove{border:none;background:transparent;color:#9ca3af;cursor:pointer;font-size:16px;line-height:1;padding:0;}\n.chip-remove:hover{color:#e5e7eb;}\n.chip-input input{flex:1;min-width:180px;border:none;outline:none;background:transparent;color:#e5e7eb;font-size:14px;padding:4px 0;}\n.chip-input input::placeholder{color:#6b7280;}\n.suggestions{position:absolute;left:0;right:0;z-index:10;margin-top:8px;max-height:260px;overflow:auto;border-radius:12px;border:1px solid #1f2937;background:#0a0f1e;padding:0;list-style:none;}\n.suggestion{display:grid;gap:2px;padding:10px 12px;border-bottom:1px solid rgba(31,41,55,.5);cursor:pointer;}\n.suggestion:last-child{border-bottom:none;}\n.suggestion span{font-size:12px;color:#9ca3af;}\n.suggestion.active{background:rgba(163,230,53,.12);}\n.hint{margin:0;color:#9ca3af;font-size:12px;}\n"
    },
    "/tsconfig.json": {
      "code": "{\n  \"compilerOptions\": {\n    \"jsx\": \"react-jsx\",\n    \"target\": \"ES2020\",\n    \"module\": \"ESNext\",\n    \"strict\": true\n  }\n}\n"
    }
  }
}
