<div class="container mx-auto max-w-7xl px-4 py-6">
  <h1 class="text-4xl font-extrabold text-white mb-6">
    {{ tech | titlecase }} Coding Challenges
  </h1>

  <!-- Filter Bar -->
  <div class="bg-gray-800 p-4 rounded-xl shadow-sm flex flex-col md:flex-row items-center md:space-x-6 mb-8 gap-4">
    <div class="flex-1 w-full md:w-1/2">
      <div class="relative">
        <i class="pi pi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
        <input pInputText type="text" placeholder="Search by titleâ€¦"
          class="w-full pl-10 pr-4 py-2 bg-gray-900 text-white border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          (input)="search$.next($any($event.target).value)" />
      </div>
    </div>

    <div class="w-full md:w-auto flex-1">
      <p-multiSelect [options]="difficultyOptions" placeholder="Difficulty" display="chip" class="w-full"
        panelStyleClass="rounded-lg" (onChange)="diffs$.next($event.value)"></p-multiSelect>
    </div>

    <div class="w-full md:w-auto flex-1">
      <label class="block mb-1 text-sm font-medium text-gray-300">Max Importance</label>
      <p-slider [(ngModel)]="sliderValue" [min]="1" [max]="5" [step]="1" class="w-full"
        (ngModelChange)="maxImp$.next($event)"></p-slider>
    </div>
  </div>

  <!-- Table-style list -->
  <div class="bg-gray-800 rounded-xl overflow-hidden">
    <div class="grid grid-cols-12 gap-4 px-6 py-3 border-b border-gray-700 text-gray-400 text-sm font-semibold">
      <div class="col-span-5">Title</div>
      <div class="col-span-2">Difficulty</div>
      <div class="col-span-1">Importance</div>
      <div class="col-span-3">Tags</div>
      <div class="col-span-1 text-right">Action</div>
    </div>

    <ng-container *ngIf="(rawQuestions$ | async) === null; else loaded">
      <div class="py-10 flex justify-center">
        <p-progressSpinner styleClass="text-blue-500"></p-progressSpinner>
      </div>
    </ng-container>

    <ng-template #loaded>
      <ng-container *ngIf="filtered$ | async as questions">
        <div *ngIf="questions.length === 0" class="py-6 text-center italic text-gray-500">
          No challenges match your filters.
        </div>

        <div *ngFor="let q of questions"
          class="grid grid-cols-12 gap-4 items-center px-6 py-4 border-b border-gray-700 hover:bg-gray-900">
          <div class="col-span-5">
            <div class="text-lg font-semibold text-white">{{ q.title }}</div>
            <div class="text-xs text-gray-400 mt-0.5">{{ descriptionText(q) | slice:0:80 }}...</div>
          </div>
          <div class="col-span-2">
            <span class="px-2 py-1 rounded text-xs font-medium" [ngClass]="{
                'bg-green-800 text-green-300': q.difficulty === 'easy',
                'bg-yellow-800 text-yellow-300': q.difficulty === 'intermediate',
                'bg-red-800 text-red-300': q.difficulty === 'hard'
              }">{{ q.difficulty | titlecase }}</span>
          </div>
          <div class="col-span-1">
            <div class="text-sm text-gray-200">{{ q.importance }}</div>
          </div>
          <div class="col-span-3 flex flex-wrap gap-2">
            <p-chip *ngFor="let tag of q.tags" [label]="tag" class="bg-gray-700 text-gray-100"></p-chip>
          </div>
          <div class="col-span-1 text-right">
            <button pButton type="button" icon="pi pi-arrow-right"
              class="p-button-text text-blue-400 hover:text-blue-500" [routerLink]="[q.id]">
              Open
            </button>
          </div>
        </div>
      </ng-container>
    </ng-template>
  </div>
</div>