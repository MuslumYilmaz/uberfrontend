<!-- src/app/features/coding/coding-list.component.html -->
<div class="container mx-auto max-w-7xl px-4 py-6">

  <!-- Page title -->
  <h1 class="text-4xl font-extrabold text-gray-900 mb-6">
    {{ tech | titlecase }} Coding Challenges
  </h1>

  <!-- Filter Bar -->
  <div class="bg-white p-4 rounded-lg shadow-sm flex flex-col md:flex-row items-center md:space-x-6 mb-8">
    <!-- Search -->
    <div class="flex-1 w-full md:w-1/2">
      <div class="relative">
        <i class="pi pi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
        <input pInputText type="text" placeholder="Search by titleâ€¦"
          class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue"
          (input)="search$.next($any($event.target).value)" />
      </div>
    </div>

    <!-- Difficulty -->
    <div class="w-full md:w-1/4 mt-4 md:mt-0">
      <p-multiSelect [options]="difficultyOptions" placeholder="Difficulty" display="chip" class="w-full"
        panelStyleClass="rounded-lg" (onChange)="diffs$.next($event.value)"></p-multiSelect>
    </div>

    <!-- Importance -->
    <div class="w-full md:w-1/4 mt-4 md:mt-0">
      <label class="block mb-1 text-sm font-medium text-gray-700">Max Importance</label>
      <p-slider [(ngModel)]="sliderValue" [min]="1" [max]="5" [step]="1" class="w-full"
        (ngModelChange)="maxImp$.next($event)"></p-slider>
    </div>
  </div>

  <!-- Cards Grid -->
  <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
    <!-- loading -->
    <ng-container *ngIf="(rawQuestions$ | async) === null; else loaded">
      <div class="col-span-full flex justify-center">
        <p-progressSpinner styleClass="text-brand-blue"></p-progressSpinner>
      </div>
    </ng-container>

    <ng-template #loaded>
      <ng-container *ngIf="filtered$ | async as questions">
        <div *ngIf="questions.length === 0" class="col-span-full text-center italic text-gray-500">
          No challenges match your filters.
        </div>

        <div *ngFor="let q of questions">
          <p-card [header]="q.title" [subheader]="q.difficulty | titlecase"
            styleClass="surface-card p-4 rounded-lg shadow hover:shadow-lg transition-transform transform hover:-translate-y-1">
            <ng-template pTemplate="content">
              <p-chip *ngFor="let tag of q.tags" [label]="tag" class="mr-2 mb-2 bg-gray-100 text-gray-700"></p-chip>
            </ng-template>
            <ng-template pTemplate="footer">
              <button pButton type="button" icon="pi pi-arrow-right" label="Open"
                class="p-button-text text-brand-blue hover:text-brand-blue-dark" [routerLink]="[ q.id ]"></button>
            </ng-template>
          </p-card>
        </div>
      </ng-container>
    </ng-template>
  </div>
</div>