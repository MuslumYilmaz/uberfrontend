{
    "version": "v2",
    "type": "user-interface",
    "title": "React • Nested Comments (solution)",
    "openFile": "/src/App.tsx",
    "dependencies": {
        "react": "18.x",
        "react-dom": "18.x",
        "react-scripts": "5.0.1"
    },
    "files": {
        "package.json": "{\n  \"name\": \"react-nested-comments-solution\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"react\": \"18.x\",\n    \"react-dom\": \"18.x\",\n    \"react-scripts\": \"5.0.1\"\n  },\n  \"scripts\": { \"start\": \"react-scripts start\" }\n}\n",
        "public/index.html": "<!doctype html><html lang=\"en\"><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><title>React SDK • Nested Comments (solution)</title></head><body><div id=\"root\"></div></body></html>",
        "src/index.tsx": "import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport App from './App';\n\ncreateRoot(document.getElementById('root')!).render(<App />);\n",
        "src/App.tsx": "import React, { useMemo, useState, useRef } from 'react';\nimport './App.css';\n\ntype CommentNode = {\n  id: string;\n  text: string;\n  children: CommentNode[];\n};\n\nexport default function App() {\n  const [comments, setComments] = useState<CommentNode[]>([]);\n  const [topDraft, setTopDraft] = useState('');\n\n  const [activeReplyId, setActiveReplyId] = useState<string | null>(null);\n  const [replyDraft, setReplyDraft] = useState('');\n\n  const nextIdRef = useRef(1);\n  const makeId = () => String(nextIdRef.current++);\n\n  const addTop = () => {\n    const text = topDraft.trim();\n    if (!text) return;\n\n    setComments((prev) => [{ id: makeId(), text, children: [] }, ...prev]);\n    setTopDraft('');\n  };\n\n  const openReply = (id: string) => {\n    setActiveReplyId(id);\n    setReplyDraft('');\n  };\n\n  const cancelReply = () => {\n    setActiveReplyId(null);\n    setReplyDraft('');\n  };\n\n  const findById = (nodes: CommentNode[], id: string): CommentNode | null => {\n    for (const n of nodes) {\n      if (n.id === id) return n;\n      const found = findById(n.children, id);\n      if (found) return found;\n    }\n    return null;\n  };\n\n  const submitReply = (parentId: string) => {\n    const text = replyDraft.trim();\n    if (!text) return;\n\n    setComments((prev) => {\n      // Shallow clone root, then mutate the found node's children.\n      // OK for this exercise (keeps code small).\n      const cloned = structuredClone(prev) as CommentNode[];\n      const parent = findById(cloned, parentId);\n      if (!parent) return prev;\n\n      parent.children.push({ id: makeId(), text, children: [] });\n      return cloned;\n    });\n\n    cancelReply();\n  };\n\n  const Tree = useMemo(() => {\n    const Render = ({ nodes, depth }: { nodes: CommentNode[]; depth: number }) => {\n      return (\n        <>\n          {nodes.map((c) => (\n            <div key={c.id} className=\"node\" style={{ marginLeft: depth * 16 }}>\n              <div className=\"bubble\">\n                <div className=\"text\">{c.text}</div>\n                <div className=\"meta\">\n                  <button className=\"ghost\" onClick={() => openReply(c.id)}>Reply</button>\n                </div>\n\n                {activeReplyId === c.id && (\n                  <div className=\"reply\">\n                    <input\n                      value={replyDraft}\n                      onChange={(e) => setReplyDraft(e.target.value)}\n                      placeholder=\"Write a reply...\"\n                    />\n                    <div className=\"replyActions\">\n                      <button onClick={() => submitReply(c.id)}>Post</button>\n                      <button className=\"ghost\" onClick={cancelReply}>Cancel</button>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {c.children.length > 0 && <Render nodes={c.children} depth={depth + 1} />}\n            </div>\n          ))}\n        </>\n      );\n    };\n    return Render;\n  }, [activeReplyId, replyDraft]);\n\n  return (\n    <main className=\"page\">\n      <section className=\"card\">\n        <h1 className=\"title\">Nested Comments (Solution)</h1>\n        <p className=\"subtitle\">Infinite replies, single active reply input, recursive rendering.</p>\n\n        <div className=\"composer\">\n          <textarea\n            rows={3}\n            value={topDraft}\n            onChange={(e) => setTopDraft(e.target.value)}\n            placeholder=\"Write a comment...\"\n          />\n          <button onClick={addTop}>Add Comment</button>\n        </div>\n\n        <div className=\"list\">\n          <Tree nodes={comments} depth={0} />\n        </div>\n\n        <div className=\"hint\">Click Reply on different comments: the input should move, not duplicate.</div>\n      </section>\n    </main>\n  );\n}\n",
        "src/App.css": ":root { color-scheme: dark; }\nhtml, body { margin: 0; height: 100%; background:#0a0a0a; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }\n\n.page { min-height:100vh; display:grid; place-items:center; background:#0a0a0a; padding:24px; }\n.card { width:100%; max-width:720px; background:#0b1020; border:1px solid #1f2937; border-radius:16px; padding:18px; display:grid; gap:14px; color:#e5e7eb; }\n.title { margin:0; font-size:20px; font-weight:900; color:#e5e7eb; }\n.subtitle { margin:0; color:#9ca3af; font-size:12px; line-height:1.45; }\n\n.composer { display:grid; gap:10px; }\ntextarea { width:100%; resize:vertical; min-height:70px; background:#0a0f1e; color:#e5e7eb; border:1px solid #1f2937; border-radius:12px; padding:10px; }\ntextarea::placeholder { color:#6b7280; }\n\n.list { display:grid; gap:10px; }\n.node { display:grid; gap:8px; }\n.bubble { background:#0a0f1e; border:1px solid #1f2937; border-radius:14px; padding:12px; display:grid; gap:10px; color:#e5e7eb; }\n.text { font-size:14px; line-height:1.4; color:#e5e7eb; }\n.meta { display:flex; gap:8px; }\n\n.reply { display:grid; gap:8px; margin-top:6px; }\n.reply input { width:100%; background:#0b1020; color:#e5e7eb; border:1px solid #1f2937; border-radius:12px; padding:10px; }\n.reply input::placeholder { color:#6b7280; }\n.replyActions { display:flex; gap:8px; flex-wrap:wrap; }\n\nbutton { background:#a3e635; color:#111; border:none; border-radius:12px; padding:10px 14px; font-weight:900; cursor:pointer; }\nbutton.ghost { background:transparent; color:#e5e7eb; border:1px solid #374151; }\n\n.hint { color:#9ca3af; font-size:12px; line-height:1.45; }\n",
        "tsconfig.json": "{\n  \"compilerOptions\": {\n    \"jsx\": \"react-jsx\",\n    \"target\": \"ES2020\",\n    \"module\": \"ESNext\",\n    \"strict\": true\n  }\n}\n"
    }
}